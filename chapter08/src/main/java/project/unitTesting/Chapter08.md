# Chapter 08: 통합 테스트를 하는 이유

---

## 통합 테스트의 역할
- **통합 테스트**: 시스템이 프로세스 외부 의존성과 통합해 작동하는 방식을 검증.
  - 컨트롤러를 다룸.
  - 회귀 방지와 리팩터링 내성이 우수.
- **단위 테스트**: 알고리즘과 도메인 모델을 검증.
  - 유지보수성과 피드백 속도가 우수.

### 테스트 활용 방안
- **단위 테스트**: 가능한 한 많은 비즈니스 시나리오의 예외 상황 확인.
- **통합 테스트**: 주요 흐름 및 단위 테스트로 확인할 수 없는 예외 상황 다룸.

---

## 빠른 실패 원칙
- 버그가 빠르게 나타나도록 설계.
- 통합 테스트에서 대안을 제시.

---

## 의존성의 종류
1. **관리 의존성**:
   - 애플리케이션을 통해서만 접근 가능.
   - 외부에서 상호작용 확인 불가.
   - 예: 데이터베이스.
   - **통합 테스트에서는 실제 인스턴스를 사용**.

2. **비관리 의존성**:
   - 다른 애플리케이션이 접근 가능.
   - 외부에서 상호작용 확인 가능.
   - 예: SMTP 서버, 메시지 버스.
   - **통합 테스트에서는 목(Mock)으로 대체**.

---

## 구현이 하나뿐인 인터페이스
- 구현이 하나뿐인 인터페이스는 추상화가 아님.
- 구체 클래스보다 결합도가 낮지 않음.
- **YAGNI 원칙 위배**: 필요하지 않은 인터페이스를 추가하지 말 것.

### 예외적인 사용 이유
- 비관리 의존성에서 목(Mock)을 사용하기 위한 경우.
- 관리 의존성에는 **구체 클래스**를 사용.

---

## 간접 계층 최소화
- 간접 계층이 많으면 코드 추론이 어려워짐.
- **3계층 구조 권장**:
  1. 도메인 모델.
  2. 애플리케이션 서비스 계층(컨트롤러).
  3. 인프라 계층.

---

## 순환 의존성 제거
- 순환 의존성은 코드 이해를 복잡하게 만듦.
- **값 객체(Value Object)**를 도입해 순환 제거.
- 호출부에 결과를 값 객체로 반환.

---

## 단위 테스트의 원칙
- 단위 테스트는 **여러 가지 실행을 포함하지 않음**.