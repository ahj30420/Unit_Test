# Chapter 10: 데이터베이스 테스트

---

## 개발 환경에서의 데이터베이스 설정
- **개발자마다 별도의 데이터베이스 인스턴스를 제공**:
  - 개발자 장비에 인스턴스를 호스팅하여 테스트 실행 속도 극대화.

---

## 데이터베이스 상태 관리
1. **상태 기반 배포 방식**:
   - 데이터베이스 상태를 명시적으로 만들고 비교 도구를 활용.
   - 병합 충돌을 쉽게 처리할 수 있음.
2. **마이그레이션 기반 배포 방식 (권장)**:
   - 데이터베이스를 명시적 마이그레이션으로 특정 상태에서 다른 상태로 전환.
   - 데이터 모션 문제를 해결하는 데 유리.
   - 모든 수정 사항을 데이터베이스 스키마에 명시적으로 적용.

---

## 비즈니스 연산 및 트랜잭션
- **비즈니스 연산은 원자적으로 업데이트**:
  - 데이터베이스 트랜잭션 메커니즘에 의존.
- **작업 단위(Unit of Work) 패턴 사용**:
  - 데이터베이스 트랜잭션에 의존하여 연산 종료 시점까지 업데이트를 지연시킴.
  - 성능 향상 가능.

---

## 테스트 원칙
1. **트랜잭션/작업 단위의 고유성 유지**:
   - 준비, 실행, 검증 구절에 각각 고유 트랜잭션/작업 단위 사용.
2. **테스트 데이터 정리**:
   - 테스트 시작 시 남은 데이터를 정리.
   - 별도의 종료 단계를 생략하고 일관성 유지.
3. **순차적 테스트 실행**:
   - 통합 테스트는 순차적으로 실행.
   - 병렬 실행은 유지비 대비 효과가 낮음.

---

## 데이터베이스 선택
- **운영 환경과 동일한 DBMS 사용**:
  - 인메모리 데이터베이스 사용 지양.
  - 운영 환경과 다른 DBMS로 테스트 시 보호 수준 저하.

---

## 테스트 범위
1. **중요 작업 중심 테스트**:
   - 복잡하거나 중요한 읽기 작업만 테스트.
   - 단순 읽기 작업은 테스트 생략.
2. **리포지터리 테스트 지양**:
   - 리포지터리는 통합 테스트 스위트로 검증.
   - 유지비 대비 회귀 방지 효과가 낮음.

---
